generator client {
  provider = "prisma-client"
  output   = "../../src/generated/prisma"

  // binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "sqlite"
}

model User {
  id                       String  @id @default(ulid())
  email                    String  @unique
  name                     String
  isSubscribedToNewsletter Boolean @default(false)

  accountType AccountType @default(INDIVIDUAL)

  totalTokensUsed Int       @default(0)
  monthlyTokens   Int       @default(0)
  lastTokenReset  DateTime?

  lastSeenAt DateTime?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  image           Image?
  password        Password?
  // subscription         Subscription?
  roles           Role[]
  sessions        Session[]
  connections     Connection[]
  likes           Like[]
  comments        Comment[]
  // bookmarks            Bookmark[]
  // tags                 Tag[]
  // reviews              Review[]
  // programs             Program[]
  // courses              Course[]
  // modules              Module[]
  // subModules           SubModule[]
  // lessons              Lesson[]
  // enrollments          Enrollment[]
  // certificates         Certificate[]
  // timeSpent            TimeSpent[]
  // teams                Team[]
  // teamMembers          TeamMember[]
  // teamInvites          TeamInvite[]
  contentReports  ContentReport[]
  resolvedReports ContentReport[] @relation("ResolvedReports")

  // // Audit log relations
  // auditLogs       AuditLog[]
  // auditLogExports AuditLogExport[]

  // // Challenge relations
  // challengeSubmissions ChallengeSubmission[]
  // challengeBadges      UserChallengeBadge[]
  // leaderboardEntries   LeaderboardEntry[]
  // userChallenges       UserChallenge[]

  // // Conversation relations
  // conversations Conversation[]

  @@index([lastSeenAt])
  @@index([createdAt])
}

enum AccountType {
  INDIVIDUAL
  COMPANY
}

model Password {
  hash String

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String @unique
}

model Image {
  id      String  @id @default(ulid())
  fileKey String
  altText String?

  user   User?   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String? @unique

  // team         Team?         @relation(fields: [teamId], references: [id], onDelete: Cascade)
  // teamSettings TeamSettings? @relation(fields: [teamId], references: [id], onDelete: Cascade)
  // teamId       String?       @unique

  // badge   Badge?  @relation(fields: [badgeId], references: [id], onDelete: Cascade)
  // badgeId String? @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
